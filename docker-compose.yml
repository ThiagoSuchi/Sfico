# Orquestra múltiplos containers (serviços) como um sistema completo.
# Facilita rodar toda a aplicação com um único comando (docker-compose up).

services: 
  api:
    build: ./Backend
    image: sfico-api:latest
    container_name: sfico-api
    ports:
      - "3080:3080"
    environment:
      - DATABASE_URL=postgresql://docker:docker@db-postgres-sfico:5432/sficodb?schema=public
    volumes:
      - ./Backend:/app
    depends_on:
      - db-postgres-sfico

  frontend: 
    build: ./Frontend
    image: sfico-frontend:latest
    container_name: sfico-front
    ports:
      - "3000:3000"
    volumes:
      - ./Frontend:/app
    command: npm run dev
    depends_on:
      - api

  db-postgres-sfico:
    image: postgres:alpine
    container_name: sfico-db
    ports:
      - "5432:5432" # Mapeamento da porta padrão do postgres 5432
    environment:
      - POSTGRES_USER=docker
      - POSTGRES_PASSWORD=docker
      - POSTGRES_DB=sficodb
    volumes:
      - api_data:/var/lib/postgresql/data

# Volumes serve para persistência de dados, caso o container seja removido
volumes:
  api_data: